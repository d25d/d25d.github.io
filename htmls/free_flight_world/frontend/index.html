
<!-- free_flight_world/frontend/index.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡ªç”±é£è¡Œä¸–ç•Œ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.loli.net/css?family=Press+Start+2P" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
        }
        /* éšè—é¼ æ ‡æŒ‡é’ˆçš„æ ·å¼ç±» */
        .hide-cursor {
            cursor: none;
        }
        #canvas-container {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        #ui-container {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        .hud-element {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 10px;
            margin: 10px;
            backdrop-filter: blur(5px);
        }
        .control-btn {
            pointer-events: auto;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.2s;
        }
        .control-btn:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.4);
        }
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        #pointer-lock-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 100;
            pointer-events: auto;
        }
        #crosshair {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            pointer-events: none;
            display: none;
        }
        #crosshair::before, #crosshair::after {
            content: '';
            position: absolute;
            background: white;
        }
        #crosshair::before {
            width: 2px;
            height: 20px;
            left: 9px;
            top: 0;
        }
        #crosshair::after {
            width: 20px;
            height: 2px;
            left: 0;
            top: 9px;
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div id="canvas-container"></div>
    
    <div id="ui-container">
        <!-- æŒ‡é’ˆé”å®šæç¤º -->
        <!-- <div id="pointer-lock-hint">
            <h3 class="text-lg mb-4">ç‚¹å‡»å±å¹•å¼€å§‹æ¸¸æˆ</h3>
            <p class="text-sm mb-4">ä½¿ç”¨WASDé”®ç§»åŠ¨ï¼Œé¼ æ ‡æ§åˆ¶è§†è§’</p>
            <button id="fullscreen-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                å…¨å±æ¨¡å¼
            </button>
        </div> -->
        
        <!-- å‡†æ˜Ÿ -->
        <div id="crosshair"></div>
        
        <!-- å·¦ä¸Šè§’çŠ¶æ€é¢æ¿ -->
        <div class="hud-element absolute top-0 left-0">
            <div>é«˜åº¦: <span id="altitude">0</span>m</div>
            <div>é€Ÿåº¦: <span id="speed">0</span>km/h</div>
            <div>æ¨¡å¼: <span id="flight-mode">æ‚¬åœ</span></div>
            <div>å¤©æ°”: <span id="weather">æ™´å¤©</span></div>
        </div>
        
        <!-- å³ä¸Šè§’ä»»åŠ¡é¢æ¿ -->
        <div class="hud-element absolute top-0 right-0">
            <h3 class="text-lg mb-2">ä»»åŠ¡</h3>
            <div id="current-task">è‡ªç”±æ¢ç´¢</div>
            <div id="task-progress">è¿›åº¦: 0/0</div>
        </div>
        
        <!-- åº•éƒ¨æ§åˆ¶é¢æ¿ -->
        <div class="absolute bottom-0 left-0 right-0 flex justify-center mb-4">
            <div class="grid grid-cols-3 gap-2" style="display: none;">
                <button class="control-btn" id="jump-btn">ğŸ¦˜</button>
                <button class="control-btn" id="fly-up-btn">ğŸ”¼</button>
                <button class="control-btn" id="mode-btn">âœˆï¸</button>
                <button class="control-btn" id="left-btn">â—€ï¸</button>
                <button class="control-btn" id="stop-btn">â¹ï¸</button>
                <button class="control-btn" id="right-btn">â–¶ï¸</button>
                <button class="control-btn" id="sprint-btn">âš¡</button>
                <button class="control-btn" id="fly-down-btn">ğŸ”½</button>
                <button class="control-btn" id="menu-btn">âš™ï¸</button>
            </div>
        </div>
    </div>

    <!-- CDN èµ„æº -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

    
    <!-- <script type="module" src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/jsm/loaders/GLTFLoader.js"></script> -->
    
    <!-- æœ¬åœ°èµ„æº -->
    <script type="module" src="js/main.js"></script>
    <script type="module" src="js/weather.js"></script>
    <script type="module" src="js/tasks.js"></script>
    
    <script>
        const body = document.body;
        // ç›‘å¬é¼ æ ‡è¿›å…¥çª—å£äº‹ä»¶
        body.addEventListener('mouseenter', function() {
        body.classList.add('hide-cursor');
        });

        // ç›‘å¬é¼ æ ‡ç¦»å¼€çª—å£äº‹ä»¶
        body.addEventListener('mouseleave', function() {
        body.classList.remove('hide-cursor');
        });

        addEventListener( 'mousedown', () => {
            document.body.requestPointerLock();//bodyé¡µé¢æŒ‡é’ˆé”å®š
        });//é¼ æ ‡é”å®š
        
        // ç²’å­èƒŒæ™¯åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80, density: { enable: true, value_area: 800 } },
                    color: { value: "#ffffff" },
                    shape: { type: "circle" },
                    opacity: { value: 0.5, random: true },
                    size: { value: 3, random: true },
                    line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.4, width: 1 },
                    move: { enable: true, speed: 2, direction: "none", random: true, straight: false, out_mode: "out" }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: {
                        onhover: { enable: true, mode: "repulse" },
                        onclick: { enable: true, mode: "push" }
                    }
                }
            });
            
            // å…¨å±æŒ‰é’®äº‹ä»¶
            // document.getElementById('fullscreen-btn').addEventListener('click', () => {
            //     if (!document.fullscreenElement) {
            //         document.documentElement.requestFullscreen().catch(err => {
            //             console.error(`å…¨å±é”™è¯¯: ${err.message}`);
            //         });
            //     } else {
            //         if (document.exitFullscreen) {
            //             document.exitFullscreen();
            //         }
            //     }
            // });
            
            // æŒ‡é’ˆé”å®šäº‹ä»¶
            // document.addEventListener('click', () => {
            //     const canvas = document.querySelector('canvas');
            //     canvas.requestPointerLock = canvas.requestPointerLock || 
            //         canvas.mozRequestPointerLock || 
            //         canvas.webkitRequestPointerLock;
            //     canvas.requestPointerLock();
            // });
            
            // æŒ‡é’ˆé”å®šçŠ¶æ€å˜åŒ–
            // document.addEventListener('pointerlockchange', () => {
            //     const isLocked = document.pointerLockElement === document.querySelector('canvas');
            //     document.getElementById('pointer-lock-hint').style.display = isLocked ? 'none' : 'block';
            //     document.getElementById('crosshair').style.display = isLocked ? 'block' : 'none';
            // });
        });
    </script>
</body>
</html>
